name: Build Code
on:
  # From push
  push:
    branches-ignore:
      - "nobuild**" # For escaping automated builds, e.g. when we don't want to use up build time quota
  # From manual run from Github Actions page
  workflow_dispatch:
jobs:
  build:
    runs-on: windows-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v4
      - name: Run builder
        run: ./tracker/run.ps1
      - name: Commit report
        run: |
          git config --global user.name 'Your Name'
          git config --global user.email 'your-username@users.noreply.github.com'
          git remote set-url origin https://x-access-token:${{ secrets.GITHUB_TOKEN }}@github.com/$GITHUB_REPOSITORY
          git checkout "${GITHUB_REF:11}"
          git add .
          git commit -am "Automated report"
          git push
